["```java\n  <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n <version>1.5.11.RELEASE</version>\n      <relativePath/>\n   </parent>\n\n   <properties>\n      <project.build.sourceEncoding>UTF-\n      8</project.build.sourceEncoding>\n      <project.reporting.outputEncoding>UTF-\n      8</project.reporting.outputEncoding>\n      <java.version>1.8</java.version>\n      <spring-cloud-function.version>\n        1.0.0.BUILD-SNAPSHOT\n      </spring-cloud-function.version>\n <reactor.version>3.1.2.RELEASE</reactor.version>\n <wrapper.version>1.0.9.RELEASE</wrapper.version>\n   </properties>\n```", "```java\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-starter-function-web</artifactId>\n</dependency>\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-function-compiler</artifactId>\n</dependency>\n\n```", "```java\n<dependencyManagement>\n  <dependencies>\n    <dependency>\n      <groupId>org.springframework.cloud</groupId>\n      <artifactId>spring-cloud-function-dependencies</artifactId>\n      <version>${spring-cloud-function.version}</version>\n      <type>pom</type>\n      <scope>import</scope>\n    </dependency>\n  </dependencies>\n</dependencyManagement>\n```", "```java\n<build>\n  <plugins>\n    <plugin>\n      <groupId>org.apache.maven.plugins</groupId>\n      <artifactId>maven-deploy-plugin</artifactId>\n      <configuration>\n        <skip>true</skip>\n      </configuration>\n    </plugin>\n    <plugin>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-maven-plugin</artifactId>\n      <dependencies>\n        <dependency>\n          <groupId>org.springframework.boot.experimental</groupId>\n          <artifactId>spring-boot-thin-layout</artifactId>\n          <version>${wrapper.version}</version>\n        </dependency>\n      </dependencies>\n    </plugin>\n  </plugins>\n</build>\n\n```", "```java\npackage com.packtpub.maskaccounts;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.function.context.FunctionScan;\nimport org.springframework.context.annotation.Bean;\nimport reactor.core.publisher.Flux;\n\nimport java.util.function.Function;\n\n@FunctionScan\n@SpringBootApplication\npublic class MaskAccountsApplication \n{\n  public static void main(String[] args) {\n    SpringApplication.run(MaskAccountsApplication.class, args);\n  }\n\n  @Bean\n  public Function<Flux<String>, Flux<String>> maskAccounts() \n  {\n return flux -> \n    {\n return flux\n      .map(value -> \n        value.replaceAll(\"\\\\w(?=\\\\w{4})\", \"*\")\n      );\n };\n }\n}\n```", "```java\nspring.cloud.function.stream.default-route: maskAccounts\nspring.cloud.function.scan.packages: com.packtpub.maskaccounts\n```", "```java\n$ mvn install\n```", "```java\n$ java -jar target/mask-accounts-0.0.1-SNAPSHOT.jar\n```", "```java\n$ curl -H \"Content-Type: text/plain\" http://localhost:8080/maskAccounts -d 37567979\n%****7979\n```", "```java\n<aws-lambda-events.version>\n    2.0.2\n</aws-lambda-events.version>\n<spring-cloud-stream-servlet.version>\n    1.0.0.BUILD-SNAPSHOT\n</spring-cloud-stream-servlet.version>\n<start-class>\n    com.packtpub.maskaccounts.MaskAccountsApplication\n</start-class>\n```", "```java\n<dependency>\n      <groupId>org.springframework.cloud</groupId>\n      <artifactId>spring-cloud-function-adapter-aws</artifactId>\n</dependency>\n<dependency>\n      <groupId>com.amazonaws</groupId>\n      <artifactId>aws-lambda-java-events</artifactId>\n      <version>${aws-lambda-events.version}</version>\n      <scope>provided</scope>\n    </dependency>\n<dependency>\n      <groupId>com.amazonaws</groupId>\n      <artifactId>aws-lambda-java-core</artifactId>\n      <version>1.1.0</version>\n      <scope>provided</scope>\n</dependency>\n```", "```java\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-stream-binder-servlet</artifactId>\n  <version>${spring-cloud-stream-servlet.version}</version>\n</dependency>\n```", "```java\n<plugin>\n  <groupId>org.apache.maven.plugins</groupId>\n  <artifactId>maven-shade-plugin</artifactId>\n  <configuration>\n    <createDependencyReducedPom>false</createDependencyReducedPom>\n    <shadedArtifactAttached>true</shadedArtifactAttached>\n    <shadedClassifierName>aws</shadedClassifierName>\n  </configuration>\n</plugin>\n```", "```java\npackage com.packtpub.maskaccounts;\n\npublic class Handler \n    extends SpringBootRequestHandler<Flux<String>, Flux<String>> {\n\n}\n```", "```java\npackage com.packtpub.maskaccounts;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.function.context.FunctionScan;\nimport org.springframework.context.annotation.Bean;\n\nimport java.util.function.Function;\n\n@FunctionScan\n@SpringBootApplication\npublic class MaskAccountsApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(MaskAccountsApplication.class, args);\n    }\n\n    @Bean\n    public Function<In, Out> function() {\n            return value -> new Out(value.mask());\n    }\n}\n\nclass In {\n\n    private String value;\n\n    In() {\n    }\n\n    public In(String value) {\n        this.value = value;\n    }\n\n    public String mask() {\n        return value.replaceAll(\"\\\\w(?=\\\\w{4})\", \"*\");\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n}\n\nclass Out {\n\n    private String value;\n\n    Out() {\n    }\n\n    public Out(String value) {\n        this.value = value;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n}\n```", "```java\n$ mvn clean package\n```", "```java\n$ aws lambda create-function --function-name maskAccounts --role arn:aws:iam::[USERID]:role/service-role/[ROLE] --zip-file fileb://target/mask-accounts-aws-0.0.1-SNAPSHOT-aws.jar --handler org.springframework.cloud.function.adapter.aws.SpringBootStreamHandler --description \"Spring Cloud Function Adapter for packt Mastering Architecting Spring 5\" --runtime java8 --region us-east-1 --timeout 30 --memory-size 1024 --publish\n```", "```java\n{\"value\": \"37567979\"}\n```", "```java\n{\"value\": \"****7979\"}\n```", "```java\n<functionAppName>function-mask-account-azure</functionAppName><functionAppRegion>westus</functionAppRegion>\n<start-class>\n    com.packtpub.maskaccounts.MaskAccountsApplication\n</start-class>\n```", "```java\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-function-adapter-azure</artifactId>\n</dependency>\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-starter-function-web</artifactId>\n  <scope>provided</scope>\n</dependency>\n<dependency>\n  <groupId>com.microsoft.azure</groupId>\n  <artifactId>azure-functions-java-core</artifactId>\n  <version>1.0.0-beta-2</version>\n  <scope>provided</scope>\n</dependency>\n```", "```java\n<plugin>\n  <groupId>com.microsoft.azure</groupId>\n  <artifactId>azure-functions-maven-plugin</artifactId>\n  <configuration>\n    <resourceGroup>java-functions-group</resourceGroup>\n    <appName>${functionAppName}</appName>\n    <region>${functionAppRegion}</region>\n    <appSettings>\n      <property>\n        <name>FUNCTIONS_EXTENSION_VERSION</name>\n        <value>beta</value>\n      </property>\n    </appSettings>\n  </configuration>\n</plugin>\n<plugin>\n  <artifactId>maven-resources-plugin</artifactId>\n  <executions>\n    <execution>\n      <id>copy-resources</id>\n      <phase>package</phase>\n      <goals>\n        <goal>copy-resources</goal>\n      </goals>\n      <configuration>\n        <overwrite>true</overwrite>\n        <outputDirectory>${project.build.directory}/azure-\n        functions/${functionAppName}\n        </outputDirectory>\n        <resources>\n          <resource>\n            <directory>${project.basedir}/src/main/azure</directory>\n            <includes>\n              <include>**</include>\n            </includes>\n          </resource>\n        </resources>\n      </configuration>\n    </execution>\n  </executions>\n</plugin>\n<plugin>\n  <groupId>org.apache.maven.plugins</groupId>\n  <artifactId>maven-shade-plugin</artifactId>\n  <configuration>\n    <createDependencyReducedPom>false</createDependencyReducedPom>\n    <shadedArtifactAttached>true</shadedArtifactAttached>\n    <shadedClassifierName>azure</shadedClassifierName>\n    <outputDirectory>${project.build.directory}/azure-\n    functions/${functionAppName}</outputDirectory>\n  </configuration>\n</plugin>\n<plugin>\n  <groupId>org.apache.maven.plugins</groupId>\n  <artifactId>maven-assembly-plugin</artifactId>\n  <executions>\n    <execution>\n      <id>azure</id>\n      <phase>package</phase>\n      <goals>\n        <goal>single</goal>\n      </goals>\n      <inherited>false</inherited>\n      <configuration>\n        <attach>false</attach>\n        <descriptor>${basedir}/src/assembly/azure.xml</descriptor>\n        <outputDirectory>${project.build.directory}/azure- \n        functions</outputDirectory>\n        <appendAssemblyId>false</appendAssemblyId>\n        <finalName>${functionAppName}</finalName>\n      </configuration>\n    </execution>\n  </executions>\n</plugin>\n```", "```java\npublic class Handler \n    extends AzureSpringBootRequestHandler<Flux<String>,Flux<String>> {\n\n    public Flux<String> execute\n                    (Flux<String>in, ExecutionContext context) {\n        return handleRequest(in, context);\n    }\n}\n```", "```java\npackage com.packtpub.maskaccounts;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.function.context.FunctionScan;\nimport org.springframework.context.annotation.Bean;\n\nimport java.util.function.Function;\n\n@FunctionScan\n@SpringBootApplication\npublic class MaskAccountsApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(MaskAccountsApplication.class, args);\n    }\n\n    @Bean\n    public Function<In, Out> maskAccount() {\n            return value -> new Out(value.mask());\n    }\n}\n\nclass In {\n\n    private String value;\n\n    In() {\n    }\n\n    public In(String value) {\n        this.value = value;\n    }\n\n    public String mask() {\n        return value.replaceAll(\"\\\\w(?=\\\\w{4})\", \"*\");\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n}\n\nclass Out {\n\n    private String value;\n\n    Out() {\n    }\n\n    public Out(String value) {\n        this.value = value;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n}\n```", "```java\n{\n   \"scriptFile\": \"../mask-accounts-azure-1.0.0.BUILD-SNAPSHOT-azure.jar\",\n   \"entryPoint\": \"com.packtpub.maskaccounts.Handler.execute\",\n\"bindings\": [\n {\n \"type\": \"httpTrigger\",\n \"name\": \"in\",\n \"direction\": \"in\",\n \"authLevel\": \"anonymous\",\n \"methods\": [\n \"get\",\n \"post\"\n ]\n },\n {\n \"type\": \"http\",\n \"name\": \"$return\",\n \"direction\": \"out\"\n }\n ],\n \"disabled\": false\n}\n```", "```java\n<assembly\n   xmlns=\"http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3\"\n   xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n   xsi:schemaLocation=\"http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd\">\n   <id>azure</id>\n   <formats>\n      <format>zip</format>\n   </formats>\n   <baseDirectory></baseDirectory>\n   <fileSets>\n      <fileSet>\n         <directory>${project.build.directory}/azure-functions/${functionAppName}</directory>\n         <outputDirectory></outputDirectory>\n         <includes>\n            <include>*-azure.jar</include>\n            <include>**/*.json</include>\n         </includes>\n      </fileSet>\n   </fileSets>\n</assembly>\n```", "```java\n$ mvn clean package\n```", "```java\n$ java -jar target/mask-accounts-azure-0.0.1-SNAPSHOT.jar\n```", "```java\n$ curl -H \"Content-Type: text/plain\" localhost:8080/maskAccount -d '{\"value\": \"37567979\"}'\n```", "```java\n$ az login\n```", "```java\n$ mvn azure-functions:deploy\n```", "```java\n$ curl https://<azure-function-url-from-the-log>/api/maskAccount -d '{\"value\": \"37567979\"}'\n```"]