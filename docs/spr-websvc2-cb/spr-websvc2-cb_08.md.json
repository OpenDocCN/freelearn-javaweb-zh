["```java\n<!--In receiver side(server-side in this chapter)-->\n<bean id=\"wss4jSecurityInterceptor\"\n<property name=\"validationActions\" value=\"UsernameToken Encrypt\" />\n..\n<!--In sender side(client-side in this chapter)-->\n<property name=\"securementActions\" value=\"UsernameToken Encrypt\" />\n..\n</bean>\n\n```", "```java\n<bean class=\"org.springframework. ws.soap.security.wss4j.support.CryptoFactoryBean\">\n<property name=\"key storePassword\" value=\"storePassword\" />\n<property name=\"key storeLocation\" value=\"/WEB-INF/store.jks\" />\n</bean>\n\n```", "```java\n    mvn clean package tomcat:run \n\n    ```", "```java\nmvn clean package \n\n```", "```java\nSent request .....\n[<SOAP-ENV:Envelope>\n<SOAP-ENV:Header>\n<wsse:Security ...>\n<wsse:UsernameToken ...>\n<wsse:Username>admin</wsse:Username>\n<wsse:Password #PasswordText\">password</wsse:Password>\n</wsse:UsernameToken>\n</wsse:Security>\n</SOAP-ENV:Header>\n....\n<tns:placeOrderRequest ...>\n....\n</tns:order>\n</tns:placeOrderRequest>\n... Received response ....\n<tns:placeOrderResponse ...\">\n<tns:refNumber>order-John_Smith_1234</tns:refNumber>\n</tns:placeOrderResponse>\n... \n\n```", "```java\n    mvn clean package tomcat:run \n\n    ```", "```java\nmvn clean package \n\n```", "```java\nSent request .....\n[<SOAP-ENV:Envelope>\n<SOAP-ENV:Header>\n<wsse:Security ...>\n<wsse:UsernameToken ...>\n<wsse:Username>admin</wsse:Username>\n<wsse:Password #PasswordDigest\">\nVstlXUXOwyKCIxYh29bNWaSKsRI=\n</wsse:Password>\n</wsse:UsernameToken>\n</wsse:Security>\n</SOAP-ENV:Header>\n....\n<tns:placeOrderRequest ...>\n....\n</tns:order>\n</tns:placeOrderRequest>\n... Received response ....\n<tns:placeOrderResponse ...\">\n<tns:refNumber>order-John_Smith_1234</tns:refNumber>\n</tns:placeOrderResponse>\n... \n\n```", "```java\n<sws:interceptors>\n....\n<bean id=\"wss4jSecurityInterceptor\" class=\"org. springframework. ws.soap.security.wss4j.Wss4jSecurityInterceptor\">\n<property name= \"validationCallbackHandler\" ref=\"callbackHandler\" />\n<property name=\"validationActions\" value=\"UsernameToken\" />\n</bean>\n</sws:interceptors>\n\n```", "```java\n<bean id=\"callbackHandler\" class=\"org.springframework.aws.soap. security.wss4j.callback.SimplePasswordValidationCallbackHandler\">\n<property name=\"users\">\n<props>\n<prop key=\"admin\">password</prop>\n</props> \n</property>\n</bean>\n\n```", "```java\n<bean id=\"wss4jSecurityInterceptor\" class=\"org.springframework.ws. soap.security.wss4j.Wss4jSecurityInterceptor\">\n<property name=\"securementActions\" value=\"UsernameToken\" /> \n<property name=\"securementUsername\" value=\"admin\" />\n<property name=\"securementPassword\" value=\"password\" />\n<property name=\"securementPasswordType\" value=\"PasswordText\" /> \n</bean>\n\n```", "```java\n<wsse:UsernameToke......>\n<wsse:Username>admin</wsse:Username>\n<wsse:Password ...#PasswordText\">password</wsse:Password>\n</wsse:UsernameToken> \n\n```", "```java\n<wsse:UsernameToken...>\n<wsse:Username>admin</wsse:Username>\n<wsse:Password ...#PasswordDigest\">\nVstlXUXOwyKCIxYh29bNWaSKsRI=\n</wsse:Password>\n...\n</wsse:UsernameToken> \n\n```", "```java\n    mvn clean package tomcat:run \n\n    ```", "```java\nmvn clean package \n\n```", "```java\nSent request .....\n[<SOAP-ENV:Envelope>\n<SOAP-ENV:Header>\n<wsse:Security ...>\n<wsse:UsernameToken ...>\n<wsse:Username>admin</wsse:Username>\n<wsse:Password #PasswordText\">password</wsse:Password>\n</wsse:UsernameToken>\n</wsse:Security>\n</SOAP-ENV:Header>\n....\n<tns:placeOrderRequest ...>\n....\n</tns:order>\n</tns:placeOrderRequest>\n... Received response ....\n<tns:placeOrderResponse ...\">\n<tns:refNumber>order-John_Smith_1234</tns:refNumber>\n</tns:placeOrderResponse>\n.... \n\n```", "```java\n    mvn clean package tomcat:run \n\n    ```", "```java\nmvn clean package \n\n```", "```java\nSent request .....\n[<SOAP-ENV:Envelope>\n<SOAP-ENV:Header>\n<wsse:Security ...>\n<wsse:UsernameToken ...>\n<wsse:Username>admin</wsse:Username>\n<wsse:Password #PasswordDigest\">\nVstlXUXOwyKCIxYh29bNWaSKsRI=</wsse:Password>\n</wsse:UsernameToken>\n</wsse:Security>\n</SOAP-ENV:Header>\n....\n<tns:placeOrderRequest ...>\n....\n</tns:order>\n</tns:placeOrderRequest>\n... Received response ....\n<tns:placeOrderResponse ...\">\n<tns:refNumber>order-John_Smith_1234</tns:refNumber>\n</tns:placeOrderResponse>\n... \n\n```", "```java\n<bean id=\"springSecurityHandler\" class=\"org.springframework.ws.soap.security. wss4j.callback.SpringPlainTextPasswordValidationCallbackHandler\">\n<property name=\"authenticationManager\" ref=\"authenticationManager\"/>\n</bean>\n<bean id=\"authenticationManager\" class= \"org.springframework.security.authentication.ProviderManager\">\n<property name=\"providers\">\n<bean class=\"org.springframework. security.authentication.dao.DaoAuthenticationProvider\">\n<property name=\"userDetailsService\" ref=\"userDetailsService\"/>\n</bean>\n</property>\n</bean>\n\n```", "```java\npublic class MyUserDetailService implements UserDetailsService {\n@Override\npublic UserDetails loadUserByUsername(String username)\nthrows UsernameNotFoundException, DataAccessException {\nreturn getUserDataFromDao(username);\n}\nprivate MyUserDetail getUserDataFromDao(String username) {\n/**\n*Real scenario: find user data from a DAO layer by userName,\n* if this user name found, populate MyUserDetail with its data(username, password,Role, ....).\n*/\nMyUserDetail mydetail=new MyUserDetail( username,\"pass\",true,true,true,true);\nmydetail.getAuthorities().add( new GrantedAuthorityImpl(\"ROLE_GENERAL_OPERATOR\"));\nreturn mydetail;\n}\n\n```", "```java\n<bean id=\"springSecurityHandler\" class=\"org.springframework.ws.soap.security.wss4j.callback. SpringDigestPasswordValidationCallbackHandler\">\n<property name=\"userDetailsService\" ref=\"userDetailsService\"/>\n</bean>\n\n```", "```java\n    mvn clean package tomcat:run \n\n    ```", "```java\nmvn clean package \n\n```", "```java\nSent request ....\n<SOAP-ENV:Header>\n<wsse:Security...>\n<ds:Signature ...>\n<ds:SignedInfo>\n.....\n</ds:SignedInfo>\n<ds:SignatureValue>\nIYSEHmk+.....\n</ds:SignatureValue>\n<ds:KeyInfo ..>\n<wsse:SecurityTokenReference ...>\n<ds:X509Data>\n<ds:X509IssuerSerial>\n<ds:X509IssuerName>\nCN=MyFirstName MyLastName,OU=Software,O=MyCompany,L=MyCity,ST=MyProvince,C=ME\n</ds:X509IssuerName>\n<ds:X509SerialNumber>1311686430</ds:X509SerialNumber>\n</ds:X509IssuerSerial>\n</ds:X509Data>\n</wsse:SecurityTokenReference>\n</ds:KeyInfo>\n</ds:Signature>\n</wsse:Security>\n</SOAP-ENV:Header>\n<SOAP-ENV:Body ...>\n<tns:placeOrderRequest ...>\n.....\n</tns:order>\n</tns:placeOrderRequest>\n.. Received response\n.....<tns:placeOrderResponse....>\n<tns:refNumber>order-John_Smith_1234</tns:refNumber>\n</tns:placeOrderResponse> \n\n```", "```java\n<sws:interceptors>\n<bean class=\"org.springframework.ws.soap.server.endpoint. interceptor.PayloadValidatingInterceptor\">\n<property name=\"schema\" value=\"/WEB-INF/orderService.xsd\" />\n<property name=\"validateRequest\" value=\"true\" />\n<property name=\"validateResponse\" value=\"true\" />\n</bean>\n<bean class=\"org.springframework.ws.soap.server.endpoint. interceptor.SoapEnvelopeLoggingInterceptor\"/>\n<bean id=\"wsSecurityInterceptor\" class=\"org.springframework.ws. soap.security.wss4j.Wss4jSecurityInterceptor\">\n<property name=\"validationActions\" value=\"Signature\" />\n<property name=\"validationSignatureCrypto\">\n<bean class=\"org.springframework.ws.soap.security. wss4j.support.CryptoFactoryBean\">\n<property name=\"key storePassword\" value=\"serverPassword\" />\n<property name=\"key storeLocation\" value=\"/WEB-INF/serverStore.jks\" />\n</bean>\n</property>\n</bean>\n</sws:interceptors>\n\n```", "```java\n<bean id=\"wss4jSecurityInterceptor\" class=\"org.springframework.ws. soap.security.wss4j.Wss4jSecurityInterceptor\">\n<property name=\"securementActions\" value=\"Signature\" />\n<property name=\"securementUsername\" value=\"client\" />\n<property name=\"securementPassword\" value=\"cliPkPassword\" />\n<property name=\"securementSignatureCrypto\">\n<bean class=\"org.springframework.ws.soap.security. wss4j.support.CryptoFactoryBean\">\n<property name=\"key storePassword\" value=\"clientPassword\" />\n<property name=\"key storeLocation\" value=\"classpath:/clientStore.jks\" />\n</bean>\n</property>\n</bean>\n\n```", "```java\nSent request ....\n<SOAP-ENV:Header>\n<wsse:Security ...>\n<wsse:BinarySecurityToken....wss-x509-token-profile- 1.0#X509v3\" ...>\nMIICbTCCAdagAwIBAgIETi6/HjANBgkqhki...\n</wsse:BinarySecurityToken>\n<ds:Signature ....>\n.....\n....\n</ds:Signature>.... \n\n```", "```java\n<property name=\"securementSignatureKeyIdentifier\" value=\"DirectReference\" />\n\n```", "```java\n    mvn clean package tomcat:run \n\n    ```", "```java\nmvn clean package \n\n```", "```java\nSent request...\n<SOAP-ENV:Header>\n<wsse:Security...>\n<xenc:ReferenceList><xenc:DataReference../> </xenc:ReferenceList>\n</wsse:Security>\n</SOAP-ENV:Header>\n<SOAP-ENV:Body>\n<xenc:EncryptedData ...>\n<xenc:EncryptionMethod..tripledes-cbc\"/>\n<ds:KeyInfo...>\n<ds:KeyName>symmetric</ds:KeyName>\n</ds:KeyInfo>\n<xenc:CipherData><xenc:CipherValue>\n3a2tx9zTnVTKl7E+Q6wm...\n</xenc:CipherValue></xenc:CipherData>\n</xenc:EncryptedData>\n</SOAP-ENV:Body>\n</SOAP-ENV:Envelope> \n\n```", "```java\n<SOAP-ENV:Header>\n<wsse:Security...>\n<xenc:EncryptionMethod ..\">\n<wsse:SecurityTokenReference ...>\n<ds:X509Data>\n<ds:X509IssuerSerial>\n<ds:X509IssuerName>\nCN=MyFirstName MyLastName,OU=Software,O=MyCompany, L=MyCity,ST=MyProvince,C=ME\n</ds:X509IssuerName>\n<ds:X509SerialNumber>1311685900</ds:X509SerialNumber>\n</ds:X509IssuerSerial>\n</ds:X509Data>\n</wsse:SecurityTokenReference>\n</ds:KeyInfo>\n<xenc:CipherData>\n<xenc:CipherValue>dn0lokNhtmZ9...</xenc:CipherValue>\n</xenc:CipherData><xenc:ReferenceList>\n....\n</wsse:Security>\n</SOAP-ENV:Header><SOAP-ENV:Body>\n<xenc:EncryptedData .../>\n<ds:KeyInfo ...xmldsig#\">\n<wsse:SecurityTokenReference ...>\n<wsse:Reference .../>\n</wsse:SecurityTokenReference>\n</ds:KeyInfo>\n<xenc:CipherData><xenc:CipherValue>\nUDO872y+r....</xenc:CipherValue>\n</xenc:CipherData></xenc:EncryptedData>\n</SOAP-ENV:Body> \n\n```", "```java\n    mvn clean package tomcat:run \n\n    ```", "```java\nmvn clean package \n\n```", "```java\n..........\n<SOAP-ENV:Body>\n<tns:placeOrderRequest...>\n<xenc:EncryptedData...>\n<xenc:EncryptionMethod .../>\n<ds:KeyInfo..xmldsig#\">\n<wsse:SecurityTokenReference ...>\n<wsse:Reference.../></wsse:SecurityTokenReference>\n</ds:KeyInfo><xenc:CipherData>\n<xenc:CipherValue>\npGzc3/j5GX......\n</xenc:CipherValue>\n</xenc:CipherData>\n</xenc:EncryptedData>\n</tns:placeOrderRequest>\n....... \n\n```", "```java\n<bean class=\"org.springframework.ws.soap. security.wss4j.Wss4jSecurityInterceptor\">\n<property name=\"validationActions\" value=\"Encrypt\"/>\n<property name=\"validationCallbackHandler\">\n<bean class=\"org.springframework.ws.soap.security. wss4j.callback.Key storeCallbackHandler\">\n<property name=\"key store\">\n<bean class=\"org.springframework.ws.soap.security. support.Key storeFactoryBean\">\n<property name=\"location\" value=\"/WEB- INF/symmetricStore.jks\"/>\n<property name=\"type\" value=\"JCEKS\"/>\n<property name=\"password\" value=\"symmetricPassword\"/>\n</bean>\n</property>\n<property name=\"symmetricKeyPassword\" value=\"keyPassword\"/>\n</bean>\n</property>\n</bean>\n\n```", "```java\n<bean class=\"org.springframework.ws.soap. security.wss4j.Wss4jSecurityInterceptor\">\n<property name=\"securementActions\" value=\"Encrypt\" />\n<property name=\"securementEncryptionKeyIdentifier\" value=\"EmbeddedKeyName\"/>\n<property name=\"securementEncryptionUser\" value=\"symmetric\"/>\n<property name=\"securementEncryptionEmbeddedKeyName\" value=\"symmetric\"/>\n<property name=\"SecurementEncryptionSymAlgorithm\" value=\"http://www.w3.org/2001/04/xmlenc#tripledes-cbc\"/>\n<property name=\"securementCallbackHandler\">\n<bean class=\"org.springframework.ws.soap.security. wss4j.callback.Key storeCallbackHandler\">\n<property name=\"symmetricKeyPassword\" value=\"keyPassword\"/>\n<property name=\"key store\">\n<bean class=\"org.springframework.ws.soap.security. support.Key storeFactoryBean\">\n<property name=\"location\" value=\"/symmetricStore.jks\"/>\n<property name=\"type\" value=\"JCEKS\"/>\n<property name=\"password\" value=\"symmetricPassword\"/>\n</bean>\n</property>\n</bean>\n</property>\n</bean>\n\n```", "```java\n<bean class=\"org.springframework.ws.soap.security. wss4j.Wss4jSecurityInterceptor\">\n<property name=\"validationActions\" value=\"Encrypt\" />\n<property name=\"validationDecryptionCrypto\">\n<bean class=\"org.springframework.ws.soap.security. wss4j.support.CryptoFactoryBean\">\n<property name=\"key storePassword\" value=\"serverPassword\" />\n<property name=\"key storeLocation\" value=\"/WEB- INF/serverStore.jks\" />\n</bean>\n</property>\n<property name=\"validationCallbackHandler\">\n<bean class=\"org.springframework.ws.soap.security. wss4j.callback.Key storeCallbackHandler\">\n<property name=\"privateKeyPassword\" value=\"serPkPassword\" />\n</bean>\n</property>\n</bean>\n\n```", "```java\n<bean class=\"org.springframework.ws.soap.security. wss4j.Wss4jSecurityInterceptor\">\n<property name=\"securementActions\" value=\"Encrypt\" />\n<property name=\"securementEncryptionUser\" value=\"server\" />\n<property name=\"securementEncryptionCrypto\">\n<bean class=\"org.springframework.ws.soap.security. wss4j.support.CryptoFactoryBean\">\n<property name=\"key storePassword\" value=\"clientPassword\" />\n<property name=\"key storeLocation\" value=\"/clientStore.jks\" />\n</bean>\n</property>\n</bean>\n\n```", "```java\n---client/server configuration file\n<property name=\"securementEncryptionParts\"value=\"{Content} {http://www.packtpub.com/LiveRestaurant/OrderService/schema} placeOrderRequest\"/>\n\n```"]