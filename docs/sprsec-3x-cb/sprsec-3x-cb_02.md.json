["```java\n<dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-core</artifactId>\n    <version>3.1.4.RELEASE</version>\n </dependency> \n <dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-web</artifactId>\n    <version>3.1.4.RELEASE</version>\n  </dependency> \n  <dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-config</artifactId>\n    <version>3.1.4.RELEASE</version>\n  </dependency>\n```", "```java\n    <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <web-app    xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" id=\"WebApp_ID\" version=\"2.5\">\n    <display-name>Struts2x</display-name>\n    <listener>  \n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>  \n    </listener>\n    <!\u2014to integrate spring with struts2->\n    <context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>/WEB-INF/applicationContext.xml</param-value>\n    </context-param>\n    <filter>\n    <filter-name>struts2</filter-name>\n    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>\n    </filter>\n\n    <filter-mapping>\n    <filter-name>struts2</filter-name>\n    <url-pattern>/*</url-pattern>\n    </filter-mapping>\n\n    </web-app>\n    ```", "```java\n    <%@ taglib prefix=\"c\" url=\"http://java.sun.com/jsp/jstl/core\"%>\n    <html>\n      <head>\n      <title>Login Page</title>\n      <style>\n        .errorblock {\n          color: #ff0000;\n          background-color: #ffEEEE;\n          border: 3px solid #ff0000;\n          padding: 8px;\n          margin: 16px;\n        }\n      </style>\n      </head>\n      <body onload='document.f.j_username.focus();'>\n        <h3>Login with Username and Password (Custom Page)</h3>\n        <% String error=request.getParameter(\"error\");\n\n        if(error!=null){\n          %>\n\n          <div class=\"errorblock\">\n          Your login attempt was not successful, try again.<br /> Caused :\n\n          </div>\n\n        <%} %>\n        <form name='f' action=\"<c:url value='/j_spring_security_check'/>\"\n        method='POST'>\n\n        <table>\n          <tr>\n            <td>User:</td>\n            <td><input type='text' name='j_username' value=''>\n            </td>\n          </tr>\n          <tr>\n            <td>Password:</td>\n            <td><input type='password' name='j_password' />\n            </td>\n          </tr>\n          <tr>\n            <td colspan='2'><input name=\"submit\" type=\"submit\"\n            value=\"submit\" />\n            </td>\n          </tr>\n          <tr>\n            <td colspan='2'><input name=\"reset\" type=\"reset\" />\n            </td>\n          </tr>\n        </table>\n\n        </form>\n      </body>\n    </html>\n    ```", "```java\n    <!DOCTYPE struts PUBLIC\n    \"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN\"\n    \"http://struts.apache.org/dtds/struts-2.0.dtd\">\n    <struts>\n      <package name=\"default\" namespace=\"/\" extends=\"struts-default\">\n      <action name=\"helloWorld\">\n        <result>success.jsp</result>\n      </action>\n\n      <action name=\"login\">\n        <result>login.jsp</result>\n      </action>\n\n      <action name=\"loginfailed\">\n        <result>login.jsp?error=true</result>\n      </action>\n\n      <action name=\"welcome\" >\n        <result>secure/hello.jsp</result>\n      </action>\n\n      </package>\n    </struts>\n    ```", "```java\n    <beans:beans xmlns=\"http://www.springframework.org\n    /schema/security\"\n       xmlns:beans=\"http://www.springframework.org\n    /schema/beans\" \n\n       xsi:schemaLocation=\"http://www.springframework.org\n    /schema/beans\n       http://www.springframework.org/schema/beans/spring-\n    beans-3.0.xsd\n       http://www.springframework.org/schema/security\n       http://www.springframework.org/schema/security/spring-\n    security-3.1.xsd\">\n\n     <global-method-security pre-post-annotations=\"enabled\">\n            <!-- AspectJ pointcut expression that locates our \"post\" method and applies security that way\n            <protect-pointcut expression=\"execution(* bigbank.*Service.post*(..))\" access=\"ROLE_TELLER\"/>\n            -->\n        </global-method-security>\n       <http auto-config=\"true\" use-expressions=\"true\" >\n              <intercept-url pattern=\"/welcome\" \n    access=\"hasRole('ROLE_USER')\"/>\n              <form-login login-page=\"/login\" default-target-\n    url=\"/welcome\" authentication-failure-\n    url=\"/loginfailed?error=true\" />\n              <logout/>\n       </http>\n        <authentication-manager>\n         <authentication-provider>\n           <user-service>\n              <user name=\"anjana\" password=\"packt123\" authorities=\"ROLE_USER\" />\n           </user-service>\n         </authentication-provider>\n       </authentication-manager>\n\n    </beans:beans>\n    ```", "```java\n    <beans:beans \n\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n       http://www.springframework.org/schema/security\n       http://www.springframework.org/schema/security/spring-security-3.1.xsd\">\n\n     <global-method-security pre-post-annotations=\"enabled\">\n            <!-- AspectJ pointcut expression that locates our \"post\" method and applies security that way\n            <protect-pointcut expression=\"execution(* bigbank.*Service.post*(..))\" access=\"ROLE_TELLER\"/>\n            -->\n        </global-method-security>\n\n      <http>\n       <intercept-url pattern=\"/welcome\" access=\"ROLE_TELLER\" />\n       <http-basic />\n      </http>\n       <authentication-manager>\n         <authentication-provider>\n           <user-service>\n             <user name=\"anjana\" password=\"123456\" authorities=\"ROLE_TELLER\" />\n           </user-service>\n         </authentication-provider>\n       </authentication-manager>\n    </beans:beans>\n    ```", "```java\npackt>java -jar jacksum.jar -a sha -q\"txt:packt123456\"\n```", "```java\n<beans:beans \n\n   xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n   http://www.springframework.org/schema/security\n   http://www.springframework.org/schema/security/spring-security-3.1.xsd\">\n\n <global-method-security pre-post-annotations=\"enabled\">\n        <!-- AspectJ pointcut expression that locates our \"post\" method and applies security that way\n        <protect-pointcut expression=\"execution(* bigbank.*Service.post*(..))\" access=\"ROLE_TELLER\"/>\n        -->\n    </global-method-security>\n  <http>\n   <intercept-url pattern=\"/welcome\" access=\"ROLE_TELLER\" />\n   <http-basic />\n  </http>\n   <authentication-manager>\n      <authentication-provider>\n   <password-encoder hash=\"sha\" />\n      <user-service>\n         <user name=\"anjana\" password=\"bde892ed4e131546a2f9997cc94d31e2c8f18b2a\" \n          authorities=\"ROLE_TELLER\" />\n      </user-service>\n   </authentication-provider>\n   </authentication-manager>\n</beans:beans>\n```", "```java\n    <%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\"%>\n    <%@page import=\"java.security.Principal\" %>\n    <html>\n    <body>\n    Hello .You are seeing a secured Page now.\n\n       <a href=\"<c:url value=\"/j_spring_security_logout\" />\" > Logout</a>\n     </body>\n    </html>\n    ```", "```java\n    <!DOCTYPE struts PUBLIC\n    \"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN\"\n    \"http://struts.apache.org/dtds/struts-2.0.dtd\">\n    <struts>\n       <package name=\"default\" namespace=\"/\" extends=\"struts-default\">\n            <action name=\"helloWorld\">\n                <result>success.jsp</result>\n            </action>\n\n          <action name=\"login\">\n                    <result>login.jsp</result>\n             </action>\n\n             <action name=\"loginfailed\">\n                    <result>login.jsp?error=true</result>\n             </action>\n\n             <action name=\"welcome\" >\n             <result>secure/hello.jsp</result>\n             </action>\n\n       <action name=\"j_spring_security_logout\">\n       <result>index.jsp</result>\n             </action>\n        </package>\n    </struts>\n    ```", "```java\n    <beans:beans \n\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n       http://www.springframework.org/schema/security\n       http://www.springframework.org/schema/security/spring-security-3.1.xsd\">\n\n     <global-method-security pre-post-annotations=\"enabled\">\n        </global-method-security>\n      <http>\n       <intercept-url pattern=\"/welcome\" access=\"ROLE_TELLER\" />\n       <logout logout-success-url=\"/helloWorld\" />\n       <http-basic />\n      </http>\n       <authentication-manager>\n          <authentication-provider>\n       <password-encoder hash=\"sha\" />\n          <user-service>\n             <user name=\"anjana\" password=\"bde892ed4e131546a2f9997cc94d31e2c8f18b2a\" \n                 authorities=\"ROLE_TELLER\" />\n          </user-service>\n       </authentication-provider>\n       </authentication-manager>\n    </beans:beans>\n    ```", "```java\n    <beans \n\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\">\n        <bean id=\"MySqlDatasource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\">\n       <property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\" />\n       <property name=\"url\" value=\"jdbc:mysql://localhost:3306/test1\" />\n       <property name=\"username\" value=\"root\" />\n       <property name=\"password\" value=\"prdc123\" />\n       </bean>\n     </beans>\n    ```", "```java\n    <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <web-app    xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\" id=\"WebApp_ID\" version=\"2.5\">\n      <display-name>SpringStruts2Security</display-name>\n     <context-param>\n              <param-name>contextConfigLocation</param-name>\n              <param-value>\n                    /WEB-INF/db-beans.xml,\n                    /WEB-INF/applicationContext-security.xml\n              </param-value>\n       </context-param>\n\n      <filter>\n        <filter-name>springSecurityFilterChain</filter-name>\n        <filter-class>\n                      org.springframework.web.filter.DelegatingFilterProxy\n                    </filter-class>\n      </filter>\n      <filter-mapping>\n        <filter-name>springSecurityFilterChain</filter-name>\n        <url-pattern>/*</url-pattern>\n      </filter-mapping>\n      <filter>\n        <filter-name>struts2</filter-name>\n        <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>\n      </filter>\n      <listener>\n        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n      </listener>\n      <filter-mapping>\n        <filter-name>struts2</filter-name>\n        <url-pattern>/*</url-pattern>\n      </filter-mapping>\n      <error-page>\n              <error-code>403</error-code>\n              <location>/secure/denied.jsp</location>\n       </error-page>\n\n      <welcome-file-list>\n        <welcome-file>index.jsp</welcome-file>\n      </welcome-file-list>\n    </web-app>\n    ```", "```java\n    CREATE TABLE `users1` (  `USER_ID` INT(10) UNSIGNED NOT NULL,\n      `USERNAME` VARCHAR(45) NOT NULL,\n      `PASSWORD` VARCHAR(45) NOT NULL,\n      `ENABLED` tinyint(1) NOT NULL,\n      PRIMARY KEY (`USER_ID`)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n    CREATE TABLE `user_roles` (\n      `USER_ROLE_ID` INT(10) UNSIGNED NOT NULL,\n      `USER_ID` INT(10) UNSIGNED NOT NULL,\n      `ROLE` VARCHAR(45) NOT NULL,\n      PRIMARY KEY (`USER_ROLE_ID`),\n      KEY `FK_user_roles` (`USER_ID`),\n      CONSTRAINT `FK_user_roles` FOREIGN KEY (`USER_ID`) REFERENCES `users` (`USER_ID`)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n    INSERT INTO test1.users (USER_ID, USERNAME,PASSWORD, ENABLED)\n    VALUES (100, 'anjana', 'packt123456', TRUE);\n\n    INSERT INTO test1.user_roles (USER_ROLE_ID, USER_ID,AUTHORITY)\n    VALUES (1, 100, 'ROLE_TELLER');\n    ```", "```java\n    <beans:beans \n\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n       http://www.springframework.org/schema/security\n       http://www.springframework.org/schema/security/spring-security-3.1.xsd\">\n\n     <global-method-security pre-post-annotations=\"enabled\">\n            <!-- AspectJ pointcut expression that locates our \"post\" method and applies security that way\n            <protect-pointcut expression=\"execution(* bigbank.*Service.post*(..))\" access=\"ROLE_TELLER\"/>\n            -->\n        </global-method-security>\n\n      <http>\n       <intercept-url pattern=\"/welcome\" access=\"ROLE_TELLER\" />\n       <logout logout-success-url=\"/helloWorld\" />\n       <http-basic />\n      </http>\n\n       <authentication-manager> \n          <authentication-provider> \n             <jdbc-user-service data-source-ref=\"MySqlDS\" \n\n                users-by-username-query=\" \n                    select username,password, enabled   \n                   from users1 where username=?\"  \n\n                authorities-by-username-query=\" \n                   select u.username, ur.role from users1 u, user_roles ur  \n             where u.user_id = ur.user_id and u.username =?  \"  \n             /> \n          </authentication-provider>\n       </authentication-manager>\n    </beans:beans>\n    ```", "```java\n    package com.packt.action;\n    public class HelloAction {\n             public String execute(){\n             return \"SUCCESS\";\n       }\n    }\n    ```", "```java\n    <!DOCTYPE struts PUBLIC\n    \"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN\"\n    \"http://struts.apache.org/dtds/struts-2.0.dtd\">\n    <struts>\n       <package name=\"default\" namespace=\"/\" extends=\"struts-default\">\n            <action name=\"helloWorld\">\n                <result>success.jsp</result>\n            </action>\n\n          <action name=\"login\">\n                   <result>login.jsp</result>\n             </action>\n\n             <action name=\"loginfailed\">\n                   <result>login.jsp?error=true</result>\n             </action>\n\n             <action name=\"welcome\" class=\"com.packt.action.HelloAction\">\n             <result name=\"SUCCESS\">secure/hello.jsp</result>\n             </action>\n\n        </package>\n    </struts>\n    ```", "```java\n        package com.packt.action;\n        import javax.servlet.http.HttpServletRequest;\n        import org.apache.struts2.ServletActionContext;\n        public class HelloAction {\n           private String name;\n                       public String execute(){\n                       HttpServletRequest request = ServletActionContext.getRequest();\n                       String logged_in_user=request.getUserPrincipal().getName();\n                       setName(logged_in_user);\n                       return \"SUCCESS\";\n                 }\n\n                 public String getName() {\n                       return name;\n                 }\n\n                 public void setName(String name) {\n                       this.name = name;\n                 }\n        }\n        ```", "```java\n        <%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\"%>\n        <%@taglib uri=\"/struts-tags\" prefix=\"s\" %>\n        <%@page import=\"java.security.Principal\" %>\n        <html>\n          <body>\n            Hello <h1><s:property value=\"name\" /></h1>.You are seeing a secured Page now.\n            <a href=\"<c:url value=\"/j_spring_security_logout\" />\" > Logout</a>\n          </body>\n        </html>\n        ```", "```java\n    <http auto-config=\"true\" use-expressions=\"true\" >\n             <intercept-url pattern=\"/welcome\" access=\"hasRole('ROLE_TELLER')\"/>\n             <form-login login-page=\"/login\" default-target-url=\"/welcome\" authentication-failure-url=\"/loginfailed?error=true\" />\n             <logout/>\n       </http>\n    ```", "```java\n    <% String error=request.getParameter(\"error\");\n\n     if(error!=null){\n     %>\n\n              <div class=\"errorblock\">\n                    Your login attempt was not successful, try again.<br /> Caused :\n\n              </div>\n\n     <%} %>\n    ```", "```java\n    <beans:beans \n\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n       http://www.springframework.org/schema/security\n       http://www.springframework.org/schema/security/spring-security-3.1.xsd\">\n\n     <global-method-security pre-post-annotations=\"enabled\">\n            <!-- AspectJ pointcut expression that locates our \"post\" method and applies security that way\n            <protect-pointcut expression=\"execution(* bigbank.*Service.post*(..))\" access=\"ROLE_TELLER\"/>\n            -->\n        </global-method-security>\n       <http auto-config=\"true\" use-expressions=\"true\" >\n              <intercept-url pattern=\"/welcome\" access=\"hasRole('ROLE_ADMIN')\"/>\n    <!--            <intercept-url pattern=\"/admin\" access=\"hasRole('ROLE_admin')\"/> -->\n\n             <form-login login-page=\"/login\" default-target-url=\"/secure/common.jsp\" authentication-failure-url=\"/loginfailed?error=true\" />\n\n    <authentication-manager>\n               <ldap-authentication-provider \n                                user-search-filter=\"(mail={0})\" \n                                user-search-base=\"ou=people\"\n                                group-search-filter=\"(uniqueMember={0})\"\n                          group-search-base=\"ou=groups\"\n                          group-role-attribute=\"cn\"\n                          role-prefix=\"ROLE_\">\n               </ldap-authentication-provider>\n       </authentication-manager>\n\n       <ldap-server url=\"ldap://localhost:10389/o=sevenSeas\" manager-dn=\"uid=admin,ou=system\" manager-password=\"secret\" />\n    </beans:beans>\n    ```"]